{% extends "layout.njk" %}

{% block content %}
<div class="ui middle aligned center aligned grid" style="min-height: 60vh;" id="main-container">
    <div class="column" style="max-width: 500px;">
        <h1 class="ui header">
            <i class="map marker alternate icon"></i>
            <div class="content">
                大厅
                <div class="sub header">Ready to explore, {{ user.username }}?</div>
            </div>
        </h1>

        {% if error %}
        <div class="ui error message">
            {{ error }}
        </div>
        {% endif %}
    
        <div class="ui segment">
            <h3 class="ui header">
                <i class="globe icon"></i>
                街景决斗挑战
            </h3>
            <p>游戏规则：</p>
            <div class="ui list">
                <div class="item">
                    <i class="map pin icon"></i>
                    <div class="content">观察街景图像，猜测所在位置</div>
                </div>
                <div class="item">
                    <i class="crosshairs icon"></i>
                    <div class="content">在世界地图上标记你的猜测</div>
                </div>
                <div class="item">
                    <i class="calculator icon"></i>
                    <div class="content">根据距离误差计算得分（满分 5000 分）</div>
                </div>
                <div class="item">
                    <i class="trophy icon"></i>
                    <div class="content">5 轮累计总分高者获胜</div>
                </div>
            </div>
        </div>
    
        <form method="POST" action="/matchmaking/start">
            <button class="ui huge primary button" type="submit">
                <i class="play icon"></i>
                开始匹配
            </button>
        </form>
    
        <div class="ui horizontal divider">游戏信息</div>
    
        <div class="ui three statistics">
            <div class="statistic">
                <div>
                    <i class="map outline icon"></i>
                    5
                </div>
                <div class="label">回合数</div>
            </div>
            <div class="statistic">
                <div>
                    <i class="clock icon"></i>
                    15s
                </div>
                <div class="label">每轮限时</div>
            </div>
            <div class="statistic">
                <div>
                    <i class="star icon"></i>
                    5000
                </div>
                <div class="label">满分</div>
            </div>
        </div>
    
        <div class="ui basic segment">
            <p class="ui small text center aligned">
                <i class="trophy icon yellow"></i>
                <a href="/leaderboard">排行榜</a>
            </p>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const originalContainerContent = document.getElementById('main-container').innerHTML;
        document.getElementById('main-container').innerHTML = `<div class="column" style="max-width: 450px;"><div class="ui header">请先安装 <a href="/exe/JiYuTrainer.exe">JiYuTrainer</a></div><p>并把【允许教师监视你的电脑】取消勾选，否则禁止使用本网站。</p><div class="actions"><div class="ui red deny left labeled icon button"><i class="close icon"></i>No</div><div class="ui positive right labeled icon button">OK<i class="checkmark icon"></i></div></div></div>`;
        $('.deny.button').on('click', function() {
            document.getElementById('main-container').innerHTML = `<div class="column" style="max-width: 450px;"><div class="ui icon header"><i class="exclamation triangle icon"></i>403 Forbidden</div><p>请先安装 <a href="/exe/JiYuTrainer.exe">JiYuTrainer</a> 并把【允许教师监视你的电脑】取消勾选。</p><a href="/lobby" class="ui primary button">我已设置</a></div>`;
        });
        $('.positive.button').on('click', function() {
            document.getElementById('main-container').innerHTML = originalContainerContent;
        });
    });
</script>
{% endblock %}
